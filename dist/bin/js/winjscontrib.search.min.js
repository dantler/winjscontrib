/* 
 * WinJS Contrib v2.1.0.7
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var WinJSContrib;!function(e){var t;!function(e){function t(e,t,r,n){return new WinJS.Promise(function(i,o){e.createFileAsync(t,r).done(function(e){Windows.Storage.FileIO.writeTextAsync(e,JSON.stringify(n)).done(function(){WinJS&&WinJS.log&&WinJS.log("File written "+e.path),i()},o)},o)})}function r(e,t){return new WinJS.Promise(function(r,n){e.createFileAsync(t,Windows.Storage.CreationCollisionOption.openIfExists).then(function(e){Windows.Storage.FileIO.readTextAsync(e).done(function(e){e?r(JSON.parse(e)):r()},n)},n)})}e.workerPath="./scripts/winjscontrib/winjscontrib.search.worker.js",e.writeWinRTFile=t,e.openWinRTFile=r}(t=e.Search||(e.Search={}))}(WinJSContrib||(WinJSContrib={}));var __global=this,WinJSContrib;!function(e){var t;!function(t){var r=e.Logs.getLogger("WinJSContrib.Search"),n=function(){function n(t,n,i){this.items=[],this.storeData=!0;var o=this;if(o.name=t||"defaultIndex",o.definition=n||{key:null,fields:null},o.items=[],o.storeData=!0,o.onprogress=void 0,o.stopWords=e.Search.Stemming.StopWords.common,o.pipeline=new e.Search.Stemming.Pipeline(n),i)o.container=i;else if(e.DataContainer&&e.DataContainer.current)o.container=e.DataContainer.current.child("WinJSContribSearch");else{if(!__global.Windows)throw"You must provide at lease a default WinJSContrib.DataContainer to persist search index";o.folderPromise=Windows.Storage.ApplicationData.current.localFolder.createFolderAsync("WinJSContribSearch",Windows.Storage.CreationCollisionOption.openIfExists).then(function(e){return e},function(e){return r.error("Folder init error "+e.message),null})}}return n.prototype.count=function(){return WinJS.Promise.wrap(this.items.length)},n.prototype.clear=function(){return this.items=[],WinJS.Promise.wrap()},n.prototype.dispose=function(){this.items=[],this.definition=void 0,this.stopWords=void 0,this.pipeline.clear(),this.pipeline=void 0,this.onprogress=void 0,this.folderPromise=void 0},n.prototype["export"]=function(){return{definition:this.definition,items:this.items}},n.prototype.toString=function(){return JSON.stringify(this["export"]())},n.prototype.loadData=function(e){var t=e;"String"==typeof t&&(t=JSON.parse(e)),t&&(t.definition&&t.definition.fields&&t.items&&t.items.length&&(this.definition=t.definition,this.pipeline.reload(this.definition)),this.items=t.items||[])},n.prototype.save=function(){var e=this,r=this["export"]();return this.container?this.container.save(this.name,r):__global.Windows?this.folderPromise.then(function(n){return t.writeWinRTFile(n,e.name,Windows.Storage.CreationCollisionOption.replaceExisting,r).then(function(t){return{index:e}})}):WinJS.Promise.wrapError({message:"you must provide a WinJSContrib.DataContainer to persist seach index"})},n.prototype.load=function(){var e=this;return this.container?this.container.read(this.name).then(function(t){e.loadData(t)}):__global.Windows?this.folderPromise.then(function(r){return t.openWinRTFile(r,e.name).then(function(t){e.loadData(t)})}):WinJS.Promise.wrapError({message:"you must provide a WinJSContrib.DataContainer to persist seach index"})},n.prototype._runSearch=function(e,t){for(var r=this,n=r.processText(e),i=[],o=r.items.length,s=-1,a=0;o>a;a++){var c=r._searchItem(n,r.items[a]);c&&i.push(c);var u=100*a/o<<0;r.onprogress&&u!=s&&r.onprogress({progressPercent:u,items:o,current:a}),s=u}return i=i.sort(function(e,t){return t.rank-e.rank}),t&&t.limit&&(i=i.slice(0,t.limit)),i},n.prototype.search=function(e,t){return WinJS.Promise.wrap(this._runSearch(e,t))},n.prototype._searchItem=function(e,t){for(var r=t.items.length,n=0,i=0;r>i;i++){var o=t.items[i];e.untokenized&&o.tokens.untokenized==e.untokenized&&(n+=4*o.weight),e.untokenized&&o.tokens.untokenized&&o.tokens.untokenized.indexOf(e.untokenized)>=0&&(n+=2*o.weight);for(var s=0;s<o.tokens.items.length;s++)for(var a=o.tokens.items[s],c=0;c<e.items.length;c++){var u=e.items[c];u.length>1&&a==u&&(n+=o.weight),u.length>2&&a.indexOf(u)>=0&&(n+=.2*o.weight)}}return n?{rank:n,key:t.key,item:t.rawdata}:void 0},n.prototype.define=function(e){this.definition=e},n.prototype._add=function(t){var n=this,i=n.definition,o={items:[],rawdata:void 0,key:void 0};if(i&&i.fields){n.storeData&&(o.rawdata=t),i.key&&(o.key=e.Utils.readProperty(t,i.key));for(var s in i.fields)if(i.fields.hasOwnProperty(s)){var a=i.fields[s],c=a.weight||1,u=e.Utils.readProperty(t,s.split("."));if(u){var p=typeof u;if("string"!==p&&null!==u.length&&void 0!==u.length)for(var h=0,f=u.length;f>h;h++){var d=u[h];d&&"string"==typeof d&&o.items.push({tokens:n.processText(d),weight:c})}else"string"===p?o.items.push({tokens:n.processText(u),weight:c}):r.warn(s+" is of type "+p)}}return n.items.push(o),WinJS.Promise.wrap(o)}},n.prototype.add=function(e){return WinJS.Promise.wrap(this._add(e))},n.prototype.addRange=function(e,t){for(var r=this,n=e.length,i=[],o=-1,s=0;n>s;s++){var a=r._add(e[s]);a&&i.push(a);var c=100*s/n<<0;t&&c!=o&&t({progressPercent:c,items:n,current:s}),o=c}return WinJS.Promise.wrap({indexed:i.length})},n.prototype.refresh=function(){var e=this,t=e.items,r=t.length;e.items=[];for(var n=0;r>n;n++){var i=e.items[n];e.add(i.rawdata)}},n.prototype.processText=function(e){"number"==typeof e&&(e=e.toString());for(var t=this.tokenize(e),r=[],n=t.length,i=0;n>i;i++){var o=this.pipeline.run(t[i]);o.length>1&&r.push(o)}return{items:r,untokenized:this.pipeline.run(e)}},n.prototype.checkWord=function(e){for(var t=this.stopWords.length,r=0;t>r;r++)if(e==this.stopWords[r])return"";return e},n.prototype.tokenize=function(e){var t=[];if(!e||!e.split)return t;for(var r=e.split(/\W+/),n=0;n<r.length;n++)r[n].length>0&&t.push(r[n]);return t},n}();t.Index=n}(t=e.Search||(e.Search={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var t;!function(t){var r=function(){function t(t){if(this.indexes={},t)for(var r in t){var n=t[r];this.indexes[r]=n.useworker?new e.Search.IndexWorkerProxy(r,n.definition):new e.Search.Index(r,n.definition)}}return t.prototype.addIndex=function(t,r,n,i){if(n)var o=new e.Search.IndexWorkerProxy(t,r);else var o=new e.Search.Index(t,r);return this.indexes[t]=o,i&&i.length?o.addRange(i).then(function(){return o}):WinJS.Promise.wrap(o)},t.prototype.addRangefunction=function(e,t){var r=this.indexes[e];return r&&t&&t.length?r.addRange(t):WinJS.Promise.wrapError({message:"search index "+e+" not found"})},t.prototype.search=function(e){function t(t,n){return n.search(e).then(function(e){e&&e.length&&e.forEach(function(e){e.searchItemType=t,r.allResults.push(e)}),r[t]=e})}var r={hasResult:!1,allResults:[]},n=[];for(var i in this.indexes)n.push(t(i,this.indexes[i]));return WinJS.Promise.join(n).then(function(){return r.allResults.sort(function(e,t){return t.rank-e.rank}),r.hasResult=r.allResults.length>0,r})},t.prototype.save=function(){var e=[];for(var t in this.indexes)e.push(this.indexes[t].save());return WinJS.Promise.join(e)},t.prototype.load=function(){var e=[];for(var t in this.indexes)e.push(this.indexes[t].load());return WinJS.Promise.join(e)},t.prototype.dispose=function(){for(var e in this.indexes)this.indexes[e].dispose();this.indexes={}},t}();t.IndexGroup=r}(t=e.Search||(e.Search={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var t;!function(t){var r=function(){function t(t,r,n){var i=this;i.worker=e.SmartWorker(n||e.Search.workerPath),i.init(t,r)}return t.prototype.init=function(e,t,r){return this.worker.start("init",{name:e,load:r,definition:t})},t.prototype.search=function(e,t){return this.worker.start("search",{searchTerm:e,options:t})},t.prototype.count=function(){return this.worker.start("count")},t.prototype.add=function(e,t){return this.worker.start("index",{items:[e],options:t})},t.prototype.addRange=function(e,t){return this.worker.start("index",{items:e,options:t})},t.prototype.dispose=function(){this.worker.dispose()},t.prototype.clear=function(){return this.worker.start("clear")},t.prototype.load=function(){return this.worker.start("load")},t.prototype.save=function(){return this.worker.start("save")},t}();t.IndexWorkerProxy=r}(t=e.Search||(e.Search={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var t;!function(t){var r;!function(t){e.Search.Stemming=e.Search.Stemming;var r=function(){function t(t){this.reload=function(t){var r=this,n=e.Search.Stemming.Presets,i=e.Search.Stemming.Op;r._processors=[];var o=null;if(t){var s=typeof t.stemming;"string"===s?o=n[t.stemming]:t.stemming&&t.stemming.length&&(o=t.stemming)}o||(o=e.Search.Stemming.Presets.standard),o.forEach(function(e){var t=i[e];t&&r._processors.push(t)})},this.reload(t)}return t.prototype.add=function(e){this._processors.push(e)},t.prototype.clear=function(){this._processors=[]},t.prototype.run=function(e){for(var t=this._processors.length,r=e,n=0;t>n;n++)r=this._processors[n](r);return r},t}();t.Pipeline=r}(r=t.Stemming||(t.Stemming={}))}(t=e.Search||(e.Search={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var t;!function(t){var r;!function(t){var r;!function(t){e.Search.Stemming.Presets=e.Search.Stemming.Presets,t.standard=["lowerCase","removeDiacritics"],t.full=["lowerCase","removeDiacritics","dedup","dropInitialLetters","dropBafterMAtEnd","transformCK","cTransform","dTransform","dropG","transformG","dropH","transformPH","transformQ","transformS","transformX","transformT","dropT","transformV","transformWH","dropW","dropY","transformZ"]}(r=t.Presets||(t.Presets={}))}(r=t.Stemming||(t.Stemming={}))}(t=e.Search||(e.Search={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var t;!function(t){var r;!function(t){var r;!function(t){e.Search.Stemming.StopWords=e.Search.Stemming.StopWords,t.common=["de","du","des","le","la","les","te","ta","ton","tes","un","une","et","ou","mais","pour","par","avec","si","a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]}(r=t.StopWords||(t.StopWords={}))}(r=t.Stemming||(t.Stemming={}))}(t=e.Search||(e.Search={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e){return e?e.toLowerCase():void 0}function r(e){return e?e.replace(/([^c])\1/g,"$1"):void 0}function n(e){return e?e.match(/^(kn|gn|pn|ae|wr)/)?e.substr(1,e.length-1):e:void 0}function i(e){return e?e.replace(/mb$/,"m"):void 0}function o(e){return e?(e=e.replace(/([^s]|^)(c)(h)/g,"$1x$3").trim(),e=e.replace(/cia/g,"xia"),e=e.replace(/c(i|e|y)/g,"s$1"),e=e.replace(/c/g,"k")):void 0}function s(e){return e?(e=e.replace(/d(ge|gy|gi)/g,"j$1"),e=e.replace(/d/g,"t")):void 0}function a(e){return e?(e=e.replace(/gh(^$|[^aeiou])/g,"h$1"),e=e.replace(/g(n|ned)$/g,"$1")):void 0}function c(e){return e?(e=e.replace(/([^g]|^)(g)(i|e|y)/g,"$1j$3"),e=e.replace(/gg/g,"g"),e=e.replace(/g/g,"k")):void 0}function u(e){return e?e.replace(/([aeiou])h([^aeiou])/g,"$1$2"):void 0}function p(e){return e?e.replace(/ck/g,"k"):void 0}function h(e){return e?e.replace(/ph/g,"f"):void 0}function f(e){return e?e.replace(/q/g,"k"):void 0}function d(e){return e?e.replace(/s(h|io|ia)/g,"x$1"):void 0}function l(e){return e?(e=e.replace(/t(ia|io)/g,"x$1"),e=e.replace(/th/,"0")):void 0}function m(e){return e?e.replace(/tch/g,"ch"):void 0}function g(e){return e?e.replace(/v/g,"f"):void 0}function v(e){return e?e.replace(/^wh/,"w"):void 0}function S(e){return e?e.replace(/w([^aeiou]|$)/g,"$1"):void 0}function w(e){return e?(e=e.replace(/^x/,"s"),e=e.replace(/x/g,"ks")):void 0}function y(e){return e?e.replace(/y([^aeiou]|$)/g,"$1"):void 0}function W(e){return e?e.replace(/z/,"s"):void 0}function x(e){return e?e.charAt(0)+e.substr(1,e.length).replace(/[aeiou]/g,""):void 0}function k(e){if(e){var t=e.toLowerCase();return t=t.replace(new RegExp("/.../g","g")," "),t=t.replace(new RegExp("[àáâãäå]","g"),"a"),t=t.replace(new RegExp("æ","g"),"ae"),t=t.replace(new RegExp("ç","g"),"c"),t=t.replace(new RegExp("[èéêë]","g"),"e"),t=t.replace(new RegExp("[ìíîï]","g"),"i"),t=t.replace(new RegExp("ñ","g"),"n"),t=t.replace(new RegExp("[òóôõö]","g"),"o"),t=t.replace(new RegExp("œ","g"),"oe"),t=t.replace(new RegExp("[ùúûü]","g"),"u"),t=t.replace(new RegExp("[ýÿ]","g"),"y"),t=t.replace(new RegExp("['\"]","g")," ")}}e.lowerCase=t,e.dedup=r,e.dropInitialLetters=n,e.dropBafterMAtEnd=i,e.cTransform=o,e.dTransform=s,e.dropG=a,e.transformG=c,e.dropH=u,e.transformCK=p,e.transformPH=h,e.transformQ=f,e.transformS=d,e.transformT=l,e.dropT=m,e.transformV=g,e.transformWH=v,e.dropW=S,e.transformX=w,e.dropY=y,e.transformZ=W,e.dropVowels=x,e.removeDiacritics=k}(t=e.Op||(e.Op={}))}(t=e.Stemming||(e.Stemming={}))}(t=e.Search||(e.Search={}))}(WinJSContrib||(WinJSContrib={}));