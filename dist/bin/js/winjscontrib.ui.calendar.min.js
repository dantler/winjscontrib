/* 
 * WinJS Contrib v2.1.0.7
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);n.prototype=t.prototype,e.prototype=new n},WinJSContrib;!function(e){var t;!function(t){var n=function(){function t(t,n){var i=this;this.element=t||document.createElement("DIV"),n=n||{},this.element.winControl=this,this.element.classList.add("mcn-datepicker"),this.element.classList.add("win-disposable"),this.flyout=new WinJS.UI.Flyout,this.flyout.element.classList.add("mcn-datepicker-flyout"),this.element.appendChild(this.flyout.element),this.flyout.onbeforeshow=function(){setImmediate(function(){i.calendar.focusSelected()})},this.flyout.onaftershow=function(){WinJS.UI&&WinJS.UI._LightDismissService&&WinJS.UI._LightDismissService._service&&WinJS.UI._LightDismissService._service._clickEaterEl&&WinJS.UI._LightDismissService._service._clickEaterEl.style&&WinJS.UI._LightDismissService._service._clickEaterEl.style.zIndex<1006&&(WinJS.UI._LightDismissService._service._clickEaterEl.style.zIndex="1006")},n.hasOwnProperty("deferRendering")||(n.deferRendering=!0);var a=document.createElement("DIV");this.flyout.element.appendChild(a);var r=JSON.parse(JSON.stringify(n));r.flyout=this.flyout,this.calendar=new e.UI.Calendar(a,r),this.calendar.onchange=function(){i.value=i.calendar.value,i.dispatchEvent("change")},this.textElement=document.createElement("DIV"),this.textElement.className="mcn-datepicker-text tap",this.element.appendChild(this.textElement),this.textElement.tabIndex=0,this.textElement.setAttribute("role","button"),this.textElement.onclick=function(e){e.preventDefault(),e.stopPropagation(),window.innerWidth<500?i.flyout.show(document.body,"top","left"):i.flyout.show(i.textElement)},WinJS.UI.setOptions(this,n),this.value||(this.value=new Date)}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.calendar.value=e,this.textElement.innerText=moment(e).format("ll"),this.flyout.hide()},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){WinJS.Utilities.disposeSubTree(this.element)},t.prototype.dispatchEvent=function(e,t){},t.prototype.addEventListener=function(e,t){},t}();t.DatePickerControl=n,t.DatePicker=WinJS.Class.mix(WinJS.Utilities.markSupportedForProcessing(n),WinJS.Utilities.eventMixin,WinJS.Utilities.createEventProperties("change"));var i=function(){function t(t,n){var i=this;if(this.element=t||document.createElement("DIV"),n=n||{},this._startDayOfWeek=1,this.eventTracker=new e.UI.EventTracker,this.element.winControl=this,this.element.classList.add("mcn-calendar"),this.element.classList.add("win-disposable"),this.onmousewheelPromise=WinJS.Promise.wrap(),WinJS.UI.setOptions(this,n),this.flyout&&(this.element.classList.add("win-xyfocus-suspended"),this.eventTracker.addEvent(this.element,"keydown",this.onkeydown.bind(this),!0)),this._ready=!1,n.deferRendering){var a=e.Utils.getScopeControl(this.element);a?a.readyComplete&&a.readyComplete.then(function(){return WinJS.Promise.timeout(200)}).then(function(){WinJS.Utilities.Scheduler.schedule(function(){i.render()},WinJS.Utilities.Scheduler.Priority.idle)}):setTimeout(function(){WinJS.Utilities.Scheduler.schedule(function(){i.render()},WinJS.Utilities.Scheduler.Priority.idle)},2e3)}else this.render()}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){"string"==typeof e&&(e=moment(e).toDate()),this._value=e,this._currentPanel&&(this._currentPanel._currentDate=new Date(e.getFullYear(),e.getMonth(),1),this._currentPanel.ensureValue())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startDayOfWeek",{get:function(){return this._startDayOfWeek},set:function(e){this._startDayOfWeek=e},enumerable:!0,configurable:!0}),t.prototype.focusSelected=function(){var e=this.element.querySelector(".day-item.selected");e&&e.focus()},t.prototype.getFocusedDay=function(){var e=this.element.querySelector("*:focus");if(e.classList.contains("day-item")){var t=e.mcnCalendarDay;return t}},t.prototype.onkeydown=function(e){if("PageDown"==e.key)this._currentPanel.next(!0),e.preventDefault(),e.stopPropagation();else if("PageUp"==e.key)this._currentPanel.previous(!0),e.preventDefault(),e.stopPropagation();else if("Down"==e.key){var t=WinJS.UI.XYFocus.findNextFocusElement("down",{focusRoot:this.element});t?t.focus():this._currentPanel.next(!0),e.preventDefault(),e.stopPropagation()}else if("Up"==e.key){var t=WinJS.UI.XYFocus.findNextFocusElement("up",{focusRoot:this.element});t?t.focus():this._currentPanel.previous(!0),e.preventDefault(),e.stopPropagation()}else if("Left"==e.key){var t=WinJS.UI.XYFocus.findNextFocusElement("left",{focusRoot:this.element});t&&t.focus(),e.preventDefault(),e.stopPropagation()}else if("Right"==e.key){var t=WinJS.UI.XYFocus.findNextFocusElement("right",{focusRoot:this.element});t&&t.focus(),e.preventDefault(),e.stopPropagation()}},t.prototype.render=function(){var t=this;if(!this._ready){this._ready=!0,this.wrapper=document.createElement("DIV"),this.wrapper.className="mcn-calendar-wrapper",this.element.appendChild(this.wrapper),this.panelsContainer=document.createElement("DIV"),this.panelsContainer.className="mcn-calendar-panels",this.wrapper.appendChild(this.panelsContainer),this.navbuttons=document.createElement("DIV"),this.navbuttons.className="navbuttons",this.wrapper.appendChild(this.navbuttons),this.navbuttonPrevious=document.createElement("BUTTON"),this.navbuttonPrevious.className="navbutton navbutton-previous",this.navbuttons.appendChild(this.navbuttonPrevious),e.UI.tap(this.navbuttonPrevious,function(){t._currentPanel&&t._currentPanel.previous()}),this.navbuttonNext=document.createElement("BUTTON"),this.navbuttonNext.className="navbutton navbutton-next",this.navbuttons.appendChild(this.navbuttonNext),e.UI.tap(this.navbuttonNext,function(){t._currentPanel&&t._currentPanel.next()});var n=this.value;n||(n=this.mindate?moment(this.mindate).toDate():new Date),this._daysPanel=new r(this,n),this._currentPanel=this._daysPanel,this._currentPanel.currentChanged=function(){t.checkState()},this.checkState(),this.element.onmousewheel=function(e){e.preventDefault(),e.stopPropagation(),t.onmousewheelPromise._state&&"success"!==t.onmousewheelPromise._state.name||t.onmousewheelPromise.then(function(){e.wheelDelta<0?t._currentPanel.allowNext()&&t._currentPanel.next():t._currentPanel.allowPrevious()&&t._currentPanel.previous(),t.onmousewheelPromise=WinJS.Promise.timeout(160)})},this._currentPanel.setNavButtonsLabels()}},t.prototype.checkState=function(){this.navbuttonNext.disabled=this._currentPanel.allowNext()?!1:!0,this.navbuttonPrevious.disabled=this._currentPanel.allowPrevious()?!1:!0},t.prototype.dispatchEvent=function(e,t){},t.prototype.addEventListener=function(e,t){},t.prototype.switchToYear=function(){this._currentPanel!=this._yearPanel&&this._currentPanel.hide(),this._yearPanel?(this._yearPanel._currentDate=this._currentPanel._currentDate,this._yearPanel.ensureValue(!0)):this._yearPanel=new l(this,this._currentPanel._currentDate),this._yearPanel.show(),this._currentPanel=this._yearPanel,this.checkState(),this._currentPanel.setNavButtonsLabels()},t.prototype.switchToMonth=function(){this._currentPanel!=this._monthsPanel&&this._currentPanel.hide(),this._monthsPanel?(this._monthsPanel._currentDate=this._currentPanel._currentDate,this._monthsPanel.ensureValue(!0)):this._monthsPanel=new s(this,this._currentPanel._currentDate),this._monthsPanel.show(),this._currentPanel=this._monthsPanel,this.checkState(),this._currentPanel.setNavButtonsLabels()},t.prototype.switchToDays=function(){this._currentPanel!=this._daysPanel&&this._currentPanel.hide(),this._daysPanel._currentDate=this._currentPanel._currentDate,this._daysPanel.ensureValue(!0),this._daysPanel.show(),this._currentPanel=this._daysPanel,this.checkState(),this._currentPanel.setNavButtonsLabels()},t.prototype.dispose=function(){this.eventTracker.dispose(),WinJS.Utilities.disposeSubTree(this.element)},t}();t.CalendarControl=i,t.Calendar=WinJS.Class.mix(WinJS.Utilities.markSupportedForProcessing(i),WinJS.Utilities.eventMixin,WinJS.Utilities.createEventProperties("change"));var a=function(){function e(e,t){this.parent=e,this.element=document.createElement("DIV"),this.element.className="calendar-panel",this.element.tabIndex=-1,this.parent.panelsContainer.appendChild(this.element),this._currentDate=new Date(t.getFullYear(),t.getMonth(),1)}return e.prototype.next=function(e){},e.prototype.previous=function(e){},e.prototype.allowNext=function(){return!1},e.prototype.allowPrevious=function(){return!1},e.prototype.ensureValue=function(e,t){},e.prototype.hide=function(){var e=this;return WinJS.UI.Animation.drillInOutgoing(this.element).then(function(){e.element.classList.add("disabled")})},e.prototype.show=function(){return this.element.classList.remove("disabled"),WinJS.UI.Animation.drillInIncoming(this.element)},e.prototype.setNavButtonsLabels=function(){},e}();t.CalendarPanelControl=a;var r=function(t){function n(e,n){t.call(this,e,n),this.element.classList.add("day-panel"),this.elementContent=document.createElement("DIV"),this.elementContent.className="calendar-panel-content",this.element.appendChild(this.elementContent),this._currentItem=new o(this,this.currentDate)}return __extends(n,t),Object.defineProperty(n.prototype,"currentDate",{get:function(){return this._currentDate},enumerable:!0,configurable:!0}),n.prototype.setNavButtonsLabels=function(){var e=WinJS.Resources.getString("mcncalendar.nextmonth.arialabel"),t=WinJS.Resources.getString("mcncalendar.previousmonth.arialabel");e.empty||t.empty||(this.parent.navbuttonNext.setAttribute("aria-label",e.value),this.parent.navbuttonPrevious.setAttribute("aria-label",t.value))},n.prototype.ensureValue=function(e,t){if(0!=moment(this.currentDate).diff(this._currentItem.currentDate))this.update(t,function(e){return WinJS.UI.Animation.drillInIncoming(e)},function(e){return WinJS.UI.Animation.drillInOutgoing(e)},e);else{$(".selected",this.element).removeClass("selected");var n="day-"+moment(this.parent.value).format("YYYY-MM-DD");$("#"+n,this.element).addClass("selected")}},n.prototype.update=function(e,t,n,i){this._currentItem.currentDate=moment(this._currentDate),this._currentItem.generateDays(e,t,n,i),this.parent.checkState()},n.prototype.next=function(t){this.allowNext()&&(this._currentDate=moment(this._currentDate).add(1,"M").toDate(),this.update(t,function(t){return e.UI.Animation.slideFromBottom(t,{duration:160})},function(t){return e.UI.Animation.slideToTop(t,{duration:160})}))},n.prototype.previous=function(t){this.allowPrevious()&&(this._currentDate=moment(this._currentDate).add(-1,"M").toDate(),this._currentItem.currentDate=moment(this._currentDate),this.update(t,function(t){return e.UI.Animation.slideFromTop(t,{duration:160})},function(t){return e.UI.Animation.slideToBottom(t,{duration:160})}))},n.prototype.allowNext=function(){if(!this.parent.maxdate)return!0;var e=moment(this._currentDate).add(1,"M").add(-1,"d").toDate();return e<moment(this.parent.maxdate).toDate()?!0:!1},n.prototype.allowPrevious=function(){return this.parent.mindate?this._currentDate>moment(this.parent.mindate).toDate()?!0:!1:!0},n}(a);t.CalendarDayPanelControl=r;var o=function(){function t(e,t){this.parent=e,this.currentDate=moment(new Date(t.getFullYear(),t.getMonth(),1)),this.element=document.createElement("DIV"),this.element.className="calendar-panel-item day-panel-item",this.element.id="month"+this.currentDate.toDate().toISOString(),this.parent.elementContent.appendChild(this.element),this.renderContent()}return t.prototype.enter=function(e){return(e=e||WinJS.UI.Animation.drillOutIncoming)(this.element)},t.prototype.renderContent=function(){var t=this,n=this.currentDate.clone().day(this.parent.parent.startDayOfWeek);this.element.innerHTML='<header role="button" tabIndex="0" data-win-focus=\'{ bottom: ".dayitem.tap" }\'>\n					<div class="month">'+this.currentDate.format("MMMM")+'</div>\n					<div class="year">'+this.currentDate.format("YYYY")+'</div>\n				</header>\n				<section class="day-items">\n					<header>\n					</header>\n					<section>\n					</section>\n				</section>',this.monthTxt=this.element.querySelector(".month"),this.yearTxt=this.element.querySelector(".year");var i=this.element.querySelector("header"),a=WinJS.Resources.getString("mcncalendar.daystitle.arialabel");a.empty||i.setAttribute("aria-label",a.value),e.UI.tap(i,function(){t.parent.parent.switchToMonth()}),this.header=this.element.querySelector(".day-items > header");for(var r=n.clone(),o=0;7>o;o++){var s=document.createElement("DIV");s.className="day-item day-header",s.innerText=r.format("ddd");var l=r.day();(0==l||6==l)&&s.classList.add("weekend"),this._lastdow=r.day(),r.add(1,"d"),this.header.appendChild(s)}this.content=this.element.querySelector(".day-items > section"),this.days=this.renderDaysWrapper(this.content)},t.prototype.destroyPanel=function(e){WinJS.Utilities.disposeSubTree(e),e.winControl.dispose(),e.parentElement.removeChild(e)},t.prototype.generateDays=function(e,t,n,i){var a=this;if(this.days){var r=this.days;i?this.destroyPanel(r):n(r).then(function(){a.destroyPanel(r)})}this.selected=null,this.days=this.renderDaysWrapper(this.content);var o=function(){if(e){var t=a.content.querySelector(".day-item.selected:not(:disabled)");t||(t=a.content.querySelector(".day-item.thismonth:not(:disabled)")),t&&t.focus()}};i?(this.monthTxt.innerText=this.currentDate.format("MMMM"),this.yearTxt.innerText=this.currentDate.format("YYYY"),o()):t(this.days).then(function(){a.monthTxt.innerText=a.currentDate.format("MMMM"),a.yearTxt.innerText=a.currentDate.format("YYYY"),o()})},t.prototype.renderDaysWrapper=function(t){var n=this,i=document.createElement("DIV");i.className="day-items-wrapper";var a=new e.UI.SwipeSlide(i,{direction:"vertical",allowed:{top:this.parent.allowNext(),bottom:this.parent.allowPrevious()}});return a.onswipe=function(e){a.swipeHandled=!0,"top"==e.direction?n.parent.next(!0):"bottom"==e.direction&&n.parent.previous(!0)},this.renderDays(i),t.appendChild(i),i},t.prototype.renderDays=function(e){var t=this,n=this.currentDate.clone().day(this.parent.parent.startDayOfWeek),i=this.currentDate.month(),a=this.parent.parent.value,r=moment(a).hour(0).minute(0).second(0).millisecond(0),o=(moment(this.parent.parent.value).hour(0).minute(0).second(0).millisecond(0),null),s=moment().hour(0).minute(0).second(0).millisecond(0);this.parent.parent.mindate&&(o=moment(this.parent.parent.mindate).hour(0).minute(0).second(0).millisecond(0));var l=null;this.parent.parent.maxdate&&(l=moment(this.parent.parent.maxdate).hour(0).minute(0).second(0).millisecond(0));var u=n.clone(),c=this.currentDate.clone().add(1,"M").add(-1,"d");c.day()!=this._lastdow&&c.day(this._lastdow+7);for(;c>=u;){var h=document.createElement("BUTTON");h.className="day-item tap",h.id="day-"+u.format("YYYY-MM-DD"),h.innerText=u.format("DD"),h.setAttribute("aria-label",u.format("L")),0==u.diff(s)&&h.classList.add("today"),a&&0==u.diff(r)&&(h.classList.add("selected"),this.selected=h);var d=u.day();(0==d||6==d)&&h.classList.add("weekend"),h.classList.add(u.month()!=i?"notthismonth":"thismonth"),o&&o>u&&(h.disabled=!0),l&&u>l&&(h.disabled=!0),h.mcnCalendarDay=u.clone(),h.onclick=function(e){var n=e.target.mcnCalendarDay;e.target.classList.add("selected"),t.selected&&t.selected.classList.remove("selected"),t.selected=e.target,t.parent.parent.value=n.toDate(),t.parent.parent.dispatchEvent("change")},u.add(1,"d"),e.appendChild(h)}},t.prototype.remove=function(t){var n=this;return t=t||WinJS.UI.Animation.drillOutOutgoing,this.element?t(this.element).then(function(){e.UI.untapAll(n.element),n.element.parentElement.removeChild(n.element),n.element=null}):WinJS.Promise.wrap()},t}();t.CalendarDayPanelContentControl=o;var s=function(t){function n(e,n){t.call(this,e,n),this.element.classList.add("month-panel"),this.renderContent()}return __extends(n,t),n.prototype.setNavButtonsLabels=function(){var e=WinJS.Resources.getString("mcncalendar.nextyear.arialabel"),t=WinJS.Resources.getString("mcncalendar.previousyear.arialabel");e.empty||t.empty||(this.parent.navbuttonNext.setAttribute("aria-label",e.value),this.parent.navbuttonPrevious.setAttribute("aria-label",t.value))},n.prototype.next=function(t){this.allowNext()&&(this._currentDate=moment(this._currentDate).add(1,"Y").toDate(),this.update(t,function(t){return e.UI.Animation.slideFromBottom(t,{duration:160})},function(t){return e.UI.Animation.slideToTop(t,{duration:160})}))},n.prototype.previous=function(t){this.allowPrevious()&&(this._currentDate=moment(this._currentDate).add(-1,"Y").toDate(),this.update(t,function(t){return e.UI.Animation.slideFromTop(t,{duration:160})},function(t){return e.UI.Animation.slideToBottom(t,{duration:160})}))},n.prototype.allowNext=function(){var e=new Date(this._currentDate.getFullYear(),11,31);return this.parent.maxdate?e<moment(this.parent.maxdate).toDate()?!0:!1:!0},n.prototype.allowPrevious=function(){var e=new Date(this._currentDate.getFullYear(),0,1);return this.parent.mindate?e>moment(this.parent.mindate).month(0).date(1).toDate()?!0:!1:!0},n.prototype.ensureValue=function(e,t){0!=moment(this._currentDate).diff(moment(this.renderedDate))&&this.update(t,function(e){return WinJS.UI.Animation.drillInIncoming(e)},function(e){return WinJS.UI.Animation.drillInOutgoing(e)},e)},n.prototype.update=function(e,t,n,i){var a=this,r=this.monthesPanel;i?r.parentElement.removeChild(r):n(this.monthesPanel).then(function(){r.parentElement.removeChild(r)}),this.monthesPanel=this.renderMonthPanel(this.content);var o=function(){if(e){var t=a.content.querySelector(".month-item.selected:not(:disabled)");t||(t=a.content.querySelector(".month-item:not(:disabled)")),t&&t.focus()}};i?(this.yearTxt.innerText=""+this._currentDate.getFullYear(),o()):t(this.monthesPanel).then(function(){a.yearTxt.innerText=""+a._currentDate.getFullYear(),o()}),this.parent.checkState()},n.prototype.renderContent=function(){var t=this;this.element.innerHTML='<header>\n					<div class="year">'+this._currentDate.getFullYear()+'</div>\n				</header>\n				<section class="month-items">\n					\n				</section>',this.yearTxt=this.element.querySelector(".year"),this.content=this.element.querySelector(".month-items"),this.monthesPanel=this.renderMonthPanel(this.content),e.UI.tap(this.element.querySelector("header"),function(){t.parent.switchToYear()})},n.prototype.renderMonthPanel=function(t){var n=this,i=document.createElement("DIV");i.className="month-itemspanel";var a=new e.UI.SwipeSlide(i,{direction:"vertical",allowed:{top:this.allowNext(),bottom:this.allowPrevious()}});a.onswipe=function(e){a.swipeHandled=!0,"top"==e.direction?n.next():"bottom"==e.direction&&n.previous()};var r=moment(new Date(this._currentDate.getFullYear(),0,1)),o=moment().hour(0).minute(0).second(0).millisecond(0),s=o.clone().date(1),l=null;this.parent.mindate&&(l=moment(this.parent.mindate).date(1).hour(0).minute(0).second(0).millisecond(0));var u=null;this.parent.maxdate&&(u=moment(this.parent.maxdate).date(1).hour(0).minute(0).second(0).millisecond(0));for(var c=0;12>c;c++){var h=document.createElement("BUTTON");h.className="month-item tap";var d=r.clone();h.mcnMonthDate=d,h.innerText=d.format("MMM"),h.setAttribute("aria-label",d.format("MMMM YYYY")),0==d.diff(s)?h.classList.add("today"):o>r&&h.classList.add("pastmonth"),l&&l>r&&(h.disabled=!0),u&&r>u&&(h.disabled=!0),h.onclick=function(e){var t=e.target,i=t.mcnMonthDate;n._currentDate=i.toDate(),n.parent.switchToDays()},i.appendChild(h),r.add(1,"M")}return t.appendChild(i),this.renderedDate=this._currentDate,i},n}(a);t.CalendarMonthPanelControl=s;var l=function(t){function n(e,n){t.call(this,e,n),this.element.classList.add("month-panel"),this.renderContent()}return __extends(n,t),n.prototype.setNavButtonsLabels=function(){var e=WinJS.Resources.getString("mcncalendar.nextyears.arialabel"),t=WinJS.Resources.getString("mcncalendar.previousyears.arialabel");e.empty||t.empty||(this.parent.navbuttonNext.setAttribute("aria-label",e.value),this.parent.navbuttonPrevious.setAttribute("aria-label",t.value))},n.prototype.next=function(t){this.allowNext()&&(this._currentDate=moment(this._currentDate).add(12,"Y").toDate(),this.update(t,function(t){return e.UI.Animation.slideFromBottom(t,{duration:160})},function(t){return e.UI.Animation.slideToTop(t,{duration:160})}))},n.prototype.previous=function(t){this.allowPrevious()&&(this._currentDate=moment(this._currentDate).add(-12,"Y").toDate(),this.update(t,function(t){return e.UI.Animation.slideFromTop(t,{duration:160})},function(t){return e.UI.Animation.slideToBottom(t,{duration:160})}))},n.prototype.allowNext=function(){var e=new Date(this._currentDate.getFullYear(),11,31);return this.parent.maxdate?e<moment(this.parent.maxdate).toDate()?!0:!1:!0},n.prototype.allowPrevious=function(){var e=new Date(this._currentDate.getFullYear(),0,1);return this.parent.mindate?e>moment(this.parent.mindate).month(0).date(1).toDate()?!0:!1:!0},n.prototype.ensureValue=function(e,t){0!=moment(this._currentDate).diff(moment(this.renderedDate))&&this.update(t,function(e){return WinJS.UI.Animation.drillInIncoming(e)},function(e){return WinJS.UI.Animation.drillInOutgoing(e)},e)},n.prototype.update=function(e,t,n,i){var a=this,r=this.yearsPanel;i?r.parentElement.removeChild(r):n(this.yearsPanel).then(function(){r.parentElement.removeChild(r)}),this.yearsPanel=this.renderYearPanel(this.content);var o=function(){if(e){var t=a.content.querySelector(".month-item.selected:not(:disabled)");t||(t=a.content.querySelector(".month-item:not(:disabled)")),t&&t.focus()}};i?(this.yearTxt.innerText=""+this._currentDate.getFullYear()+" - "+moment(this._currentDate).add("Y",11).toDate().getFullYear(),o()):t(this.yearsPanel).then(function(){a.yearTxt.innerText=""+a._currentDate.getFullYear()+" - "+moment(a._currentDate).add("Y",11).toDate().getFullYear(),o()}),this.parent.checkState()},n.prototype.renderContent=function(){this.element.innerHTML='<header>\n					<div class="year">'+this._currentDate.getFullYear()+" - "+moment(this._currentDate).add("Y",11).toDate().getFullYear()+'</div>\n				</header>\n				<section class="month-items">\n					\n				</section>',this.yearTxt=this.element.querySelector(".year"),this.content=this.element.querySelector(".month-items"),this.yearsPanel=this.renderYearPanel(this.content)},n.prototype.renderYearPanel=function(t){var n=this,i=document.createElement("DIV");i.className="month-itemspanel";var a=new e.UI.SwipeSlide(i,{direction:"vertical",allowed:{top:this.allowNext(),bottom:this.allowPrevious()}});a.onswipe=function(e){a.swipeHandled=!0,"top"==e.direction?n.next():"bottom"==e.direction&&n.previous()};var r=moment(new Date(this._currentDate.getFullYear(),0,1)),o=moment().hour(0).minute(0).second(0).millisecond(0),s=o.clone().date(1),l=null;this.parent.mindate&&(l=moment(this.parent.mindate).date(1).hour(0).minute(0).second(0).millisecond(0));var u=null;this.parent.maxdate&&(u=moment(this.parent.maxdate).date(1).hour(0).minute(0).second(0).millisecond(0));for(var c=0;12>c;c++){var h=document.createElement("BUTTON");h.className="month-item tap";var d=r.clone();h.mcnMonthDate=d,h.innerText=d.format("YYYY"),h.setAttribute("aria-label",d.format("YYYY")),0==d.diff(s)?h.classList.add("today"):o>r&&h.classList.add("pastmonth"),l&&l>r&&(h.disabled=!0),u&&r>u&&(h.disabled=!0),h.onclick=function(e){var t=e.target,i=t.mcnMonthDate;n._currentDate=i.toDate(),n.parent.switchToMonth()},i.appendChild(h),r.add(1,"Y")}return t.appendChild(i),this.renderedDate=this._currentDate,i},n}(a);t.CalendarYearPanelControl=l}(t=e.UI||(e.UI={}))}(WinJSContrib||(WinJSContrib={}));