/* 
 * WinJS Contrib v2.1.0.7
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var WinJSContrib=WinJSContrib||{};WinJSContrib.WinRT=WinJSContrib.WinRT||{};var __global=this;!function(){"use strict";function e(e,r){for(var n in r)e[n]=r[n]}function r(){var e=Windows.System.Profile.HardwareIdentification.getPackageSpecificToken(null),r=Windows.Storage.Streams.DataReader.fromBuffer(e.id),n=new Array(e.id.length);r.readBytes(n);for(var t="",i=0;i<n.length;i++)t+=n[i].toString();return t}function n(){var e=Windows.Networking.Connectivity.NetworkInformation.getConnectionProfiles(),r=e[0].networkAdapter;return r.ianaInterfaceType.toString()}WinJSContrib.WinRT.AppInsight=function(t){var i=this;if(!t||!t.instrumentationKey)throw new Error("you must provide an instrumentationKey "+instrumentationKey);t.endpointUrl=t.endpointUrl||"http://dc.services.visualstudio.com/v2/track",i.options=t,i.tracker=new Microsoft.ApplicationInsights.AppInsights(t);var o=new Windows.ApplicationModel.Resources.Core.ResourceContext,a=window.navigator.language,c=o.qualifierValues.homeRegion,s=o.qualifierValues.deviceFamily,l=Windows.ApplicationModel.Package.current.id.version,p=(Windows.System.Profile.HardwareIdentification.getPackageSpecificToken(null),r()),d=new Windows.Security.ExchangeActiveSyncProvisioning.EasClientDeviceInformation,u={"ai.application.ver":l.major+"."+l.minor+"."+l.build+"."+l.revision,"ai.device.type":s,"ai.device.id":p,"ai.device.oemName":d.systemManufacturer,"ai.device.model":d.systemProductName,"ai.device.network":n(),"ai.device.language":a,"ai.user.storeRegion":c};i.tracker.context.addTelemetryInitializer(function(r){e(r.tags,u);var n=r.data.baseData;if(n){var t="Microsoft.ApplicationInsights.",o=null;if(r.name&&0==r.name.indexOf(t)){o=r.name.substr(t.length);var a=i.options.instrumentationKey,c=t+a.replace(/-/g,"")+"."+o;r.name=c}"Exception"===o&&n.exceptions&&n.exceptions.length&&n.exceptions.forEach(function(e){e.id=62619566,e.typeName=e.message})}}),__global.WinJS?WinJS.Application.addEventListener("error",function(e){e.detail.setPromise(WinJS.Promise.timeout(5e3));var r=i.wrapError(e.detail);return r?i.tracker.trackException(r,"Unhandled"):i.tracker.trackException("unknown error","Unhandled",r),i.tracker.flush(),i.onerror?i.onerror(e):void 0}):window.addEventListener("error",function(e,r,n){if(e){var t=e.error;t||(t={message:e.message,stack:e.filename+":"+e.lineno+":"+e.colno}),i.tracker.trackException(i.wrapError(t),"Unhandled"),i.tracker.flush()}}),__global.WinJSContrib&&__global.WinJSContrib.UI&&__global.WinJSContrib.UI.tap&&WinJS.Application.addEventListener("mcn-taperror",function(e){if(!e.error||"Canceled"!=e.error.message){var r=i.wrapError(e.error||e.detail.error);return r?i.tracker.trackException(r,"Unhandled tap error"):i.tracker.trackException("unknown tap error","Unhandled tap error",e.error||e.detail),i.tracker.flush(),i.ontaperror?i.ontaperror(e):void 0}})},WinJSContrib.WinRT.AppInsight.prototype.wrapError=function(e){if(e){if("[object Error]"===Object.prototype.toString.call(e))return e;var r=e.error;if(r){if("[object Error]"===Object.prototype.toString.call(r))return r;r.error?r=r.error:r.exception&&(r=r.exception)}else if(e.exception){if(r=e.exception,"[object Error]"===Object.prototype.toString.call(r))return r;r.error?r=r.error:r.exception&&(r=r.exception)}if("[object Error]"===Object.prototype.toString.call(r))return r;var n=e;if(e.detail&&(e.detail.message||e.detail.errorMessage)&&(n=e.detail),n.message||n.errorMessage){var t=new Error(n.message||n.errorMessage);return t.stack=n.stack,n.errorUrl&&!n.stack?t.stack=n.errorMessage+" at "+n.errorUrl+":"+n.errorLine+n.errorCharacter:n.filename&&!n.stack&&(t.stack=n.message+" at "+e.filename+":"+e.lineno+":"+e.colno),t}return null}},WinJSContrib.WinRT.AppInsight.prototype.wrapWinJSNavigation=function(e){var r=this;WinJS.Navigation.addEventListener("navigated",function(n){var t=n.detail;r.tracker.trackPageView(null,t.location,e?null:t.state)})}}();